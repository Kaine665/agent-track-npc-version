# 00-快速开始指南

**文档版本**：v1.0  
**最后更新**：2024-12-19  
**适用对象**：单人开发 + AI 协作

---

## 📌 重要说明

本文档是**实际开发执行指南**，与详细的产品文档不同，这里关注的是：

- **如何开始**：第一步做什么
- **如何推进**：下一步做什么
- **如何协作**：如何与 AI 配合
- **如何验证**：如何确认完成

**原则**：先跑起来，再完善。不要一开始就追求完美。

---

## 🤝 协作方式

### 协作模式

**你（开发者）** + **我（AI 助手）** = 两人协作开发

### 消息同步机制

#### 1. 进度记录文件

**重要规范**：AI 助手在记录日志时，必须先通过工具获取当天时间（使用 `run_terminal_cmd` 获取系统日期），确保日期准确。

每次完成一个任务后，更新进度记录文件，格式如下：

```markdown
## 开发进度记录

### 当前阶段：阶段 X - [阶段名称]

### 当前任务：[具体任务名称]

### 完成时间：[日期]

### 已完成任务

- [x] 任务 1
- [x] 任务 2

### 进行中任务

- [ ] 任务 3（进行中...）

### 遇到的问题

- 问题 1：[描述] - 已解决/待解决
- 问题 2：[描述] - 已解决/待解决

### 下一步计划

- [ ] 任务 4
- [ ] 任务 5
```

#### 2. 每次对话的开始

**你告诉我**：

```
当前进度：[你在哪个阶段]
当前任务：[你在做什么]
遇到的问题：[如果有]
下一步计划：[你想做什么]
```

**我会**：

- 了解你的进度
- 提供具体的实现步骤
- 给出代码示例
- 解答问题

#### 3. 任务完成后的沟通

**你告诉我**：

```
已完成：[任务名称]
结果：[是否成功，遇到了什么问题]
下一步：[你想做什么]
```

**我会**：

- 确认完成情况
- 提供下一步的具体指导
- 帮助解决遗留问题

---

## 🗺️ 开发路线图

### 总体策略

```
阶段 0：项目准备（1-2 天）
  ↓
阶段 1：最小 MVP（3-5 天）
  ├─ 后端基础框架
  ├─ 前端基础框架
  └─ 第一个功能：创建 NPC
  ↓
阶段 2：核心功能（5-7 天）
  ├─ 对话功能
  └─ 对话历史
  ↓
阶段 3：完善和优化（3-5 天）
  ├─ 错误处理
  ├─ UI 优化
  └─ 测试和修复
```

---

## 📋 详细开发计划

### 阶段 0：项目准备（1-2 天）

#### 目标

搭建开发环境，确定技术栈，初始化项目。

#### 任务清单

**任务 0.1：确定技术栈**

**你告诉我**：

- 你熟悉的前端框架（React/Vue/其他）
- 你熟悉的后端框架（Express/Koa/其他）
- 你熟悉的数据库（PostgreSQL/MySQL/SQLite）

**我会**：

- 根据你的选择提供技术栈建议
- 提供项目初始化命令

**验证**：技术栈确定，项目可以初始化

---

**任务 0.2：初始化后端项目**

**你告诉我**：`我要初始化后端项目`

**我会提供**：

- 项目初始化命令
- 基础目录结构
- 基础配置文件

**你需要做**：

```bash
# 1. 创建项目目录
mkdir npc-backend
cd npc-backend

# 2. 初始化 npm 项目
npm init -y

# 3. 安装依赖（我会告诉你具体依赖）
npm install express cors dotenv
npm install -D nodemon

# 4. 创建基础文件结构
# （我会告诉你创建哪些文件）
```

**验证**：运行 `npm start` 能看到服务器启动

---

**任务 0.3：初始化前端项目**

**你告诉我**：`我要初始化前端项目`

**我会提供**：

- 项目初始化命令（Vite/CRA/其他）
- 基础目录结构
- 基础配置文件

**你需要做**：

```bash
# 1. 创建项目目录
mkdir npc-frontend
cd npc-frontend

# 2. 初始化项目（根据你选择的框架）
# React + Vite
npm create vite@latest . -- --template react

# 或 Vue + Vite
npm create vite@latest . -- --template vue

# 3. 安装依赖
npm install
npm install axios  # HTTP 客户端
```

**验证**：运行 `npm run dev` 能看到前端页面

---

**任务 0.4：配置数据库**

**你告诉我**：`我要配置数据库`

**我会提供**：

- 数据库连接配置
- 数据库初始化脚本
- ORM 配置（如果需要）

**验证**：能够成功连接数据库

---

### 阶段 1：最小 MVP（3-5 天）

#### 目标

实现一个可以创建 NPC 并显示在列表中的最小版本。

#### 任务清单

**任务 1.1：创建数据库表**

**你告诉我**：`我要创建 agents 表`

**我会提供**：

- SQL 建表语句
- 数据库迁移脚本（如果需要）

**你需要做**：

```sql
-- 创建 agents 表
CREATE TABLE agents (
  id VARCHAR(100) PRIMARY KEY,
  user_id VARCHAR(100) NOT NULL,
  name VARCHAR(50) NOT NULL,
  type ENUM('general', 'special') NOT NULL,
  model VARCHAR(50) NOT NULL,
  system_prompt TEXT NOT NULL,
  avatar_url VARCHAR(500),
  created_at BIGINT NOT NULL,
  updated_at BIGINT NOT NULL
);
```

**验证**：表创建成功，可以插入测试数据

---

**任务 1.2：实现创建 NPC API**

**你告诉我**：`我要实现创建 NPC 的 API`

**我会提供**：

- 完整的 API 代码
- 路由配置
- 数据验证逻辑

**你需要做**：

1. 创建路由文件 `routes/agents.js`
2. 创建服务文件 `services/AgentService.js`
3. 创建数据访问文件 `repositories/AgentRepository.js`
4. 测试 API（使用 Postman 或 curl）

**验证**：能够通过 API 成功创建 NPC

---

**任务 1.3：实现获取 NPC 列表 API**

**你告诉我**：`我要实现获取 NPC 列表的 API`

**我会提供**：

- 完整的 API 代码
- 排序逻辑

**验证**：能够通过 API 获取 NPC 列表

---

**任务 1.4：实现前端创建 NPC 页面**

**你告诉我**：`我要实现创建 NPC 的前端页面`

**我会提供**：

- 表单组件代码
- API 调用代码
- 表单验证逻辑

**验证**：能够在前端创建 NPC

---

**任务 1.5：实现前端 NPC 列表页面**

**你告诉我**：`我要实现 NPC 列表页面`

**我会提供**：

- 列表组件代码
- 卡片组件代码
- API 调用代码

**验证**：能够在前端看到 NPC 列表

---

### 阶段 2：核心功能（5-7 天）

#### 目标

实现对话功能，能够发送消息并收到 AI 回复。

#### 任务清单

**任务 2.1：创建 events 表**

**你告诉我**：`我要创建 events 表`

**我会提供**：

- SQL 建表语句

**验证**：表创建成功

---

**任务 2.2：集成 LLM API**

**你告诉我**：`我要集成 LLM API（OpenAI/其他）`

**我会提供**：

- LLM SDK 配置
- API 调用封装代码
- 错误处理和重试逻辑

**你需要告诉我**：

- 你使用的 LLM 提供商（OpenAI/Anthropic/其他）
- API Key（我会帮你配置，注意安全）

**验证**：能够成功调用 LLM API 并获得回复

---

**任务 2.3：实现发送消息 API**

**你告诉我**：`我要实现发送消息的 API`

**我会提供**：

- 完整的消息处理流程代码
- Prompt 构建逻辑
- 上下文获取逻辑

**验证**：能够通过 API 发送消息并收到回复

---

**任务 2.4：实现获取对话历史 API**

**你告诉我**：`我要实现获取对话历史的 API`

**我会提供**：

- 查询逻辑代码
- 排序逻辑

**验证**：能够获取对话历史

---

**任务 2.5：实现前端对话页面**

**你告诉我**：`我要实现对话页面`

**我会提供**：

- 对话界面布局代码
- 消息气泡组件
- 输入框组件
- 消息发送逻辑

**验证**：能够在前端发送消息并显示回复

---

**任务 2.6：实现前端对话历史加载**

**你告诉我**：`我要实现对话历史加载`

**我会提供**：

- 历史记录加载逻辑
- 消息渲染逻辑

**验证**：能够加载并显示历史对话

---

### 阶段 3：完善和优化（3-5 天）

#### 目标

完善错误处理、UI 优化、测试和修复 Bug。

#### 任务清单

**任务 3.1：完善错误处理**

**你告诉我**：`我要完善错误处理`

**我会提供**：

- 统一错误处理中间件
- 前端错误提示组件
- 错误处理最佳实践

**验证**：各种错误情况都有友好的提示

---

**任务 3.2：UI 优化**

**你告诉我**：`我要优化 UI`

**我会提供**：

- UI 改进建议
- 样式优化代码
- 响应式设计实现

**验证**：界面美观、响应式良好

---

**任务 3.3：测试和修复 Bug**

**你告诉我**：`我要测试和修复 Bug`

**我会提供**：

- 测试清单
- Bug 修复建议

**验证**：主要功能正常运行，无明显 Bug

---

## 🔄 协作流程示例

### 示例 1：开始新任务

**你**：

```
当前进度：阶段 1 - 最小 MVP
当前任务：任务 1.2 - 实现创建 NPC API
遇到的问题：无
下一步计划：实现创建 NPC 的后端 API
```

**我**：

```
好的，我来帮你实现创建 NPC 的 API。

需要创建以下文件：
1. routes/agents.js - 路由文件
2. services/AgentService.js - 服务层
3. repositories/AgentRepository.js - 数据访问层

让我先给你路由文件的代码...
```

---

### 示例 2：遇到问题

**你**：

```
当前进度：阶段 1 - 最小 MVP
当前任务：任务 1.2 - 实现创建 NPC API
遇到的问题：数据库连接失败，错误信息：xxx
下一步计划：解决数据库连接问题
```

**我**：

```
看起来是数据库连接配置的问题。让我帮你排查：

1. 检查数据库连接字符串是否正确
2. 检查数据库服务是否启动
3. 检查防火墙设置

请提供：
- 你的数据库配置代码
- 完整的错误信息
```

---

### 示例 3：完成任务

**你**：

```
已完成：任务 1.2 - 实现创建 NPC API
结果：成功，API 可以正常创建 NPC
下一步：任务 1.3 - 实现获取 NPC 列表 API
```

**我**：

```
太好了！创建 NPC API 已经完成。

现在我们来实现获取 NPC 列表的 API。
这个相对简单，主要是查询数据库并返回列表。

让我给你代码...
```

---

## 🐛 问题处理

### 发现问题时

如果发现代码错误、文档错误或其他问题，请：

1. **记录到问题文档**：更新 `实现问题记录.md`
2. **告诉我问题**：描述问题、错误信息、你的修复方案（如果有）
3. **我会提供帮助**：给出修复方案、更新相关文档（如果需要）

详见：[实现问题记录](../实现问题记录.md)

---

## 📝 进度记录模板

创建一个文件 `开发进度.md`，每次完成任务后更新：

```markdown
# 开发进度记录

## 当前状态

- **阶段**：阶段 1 - 最小 MVP
- **当前任务**：任务 1.2 - 实现创建 NPC API
- **开始时间**：2024-12-19
- **预计完成**：2024-12-20

## 已完成任务

- [x] 任务 0.1：确定技术栈（2024-12-19）
- [x] 任务 0.2：初始化后端项目（2024-12-19）
- [x] 任务 0.3：初始化前端项目（2024-12-19）
- [x] 任务 0.4：配置数据库（2024-12-19）
- [x] 任务 1.1：创建 agents 表（2024-12-19）

## 进行中任务

- [ ] 任务 1.2：实现创建 NPC API（进行中...）

## 遇到的问题

- 问题 1：数据库连接失败 - 已解决（配置错误）
- 问题 2：暂无

## 下一步计划

- [ ] 任务 1.3：实现获取 NPC 列表 API
- [ ] 任务 1.4：实现前端创建 NPC 页面
- [ ] 任务 1.5：实现前端 NPC 列表页面

## 备注

- 技术栈：React + Express + PostgreSQL
- 开发环境：Windows 10
```

---

## 🎯 关键原则

### 1. 小步快跑

- 每次只关注一个任务
- 完成一个任务再开始下一个
- 不要试图一次性完成所有功能

### 2. 先跑起来

- 先实现核心功能，让系统能够运行
- 再逐步完善细节
- 不要一开始就追求完美

### 3. 及时沟通

- 遇到问题立即告诉我
- 完成任务后告诉我
- 不确定的地方问我

### 4. 持续验证

- 每个任务完成后都要验证
- 确保功能正常工作再继续
- 不要积累太多未验证的代码

---

## 🚀 现在开始

### 第一步：告诉我你的情况

请告诉我：

1. **你的技术栈偏好**：

   - 前端：React / Vue / 其他？
   - 后端：Express / Koa / 其他？
   - 数据库：PostgreSQL / MySQL / SQLite？

2. **你的开发环境**：

   - 操作系统：Windows / macOS / Linux？
   - Node.js 版本：？

3. **你的当前进度**：

   - 项目是否已初始化？
   - 是否已有代码？

4. **你想从哪里开始**：
   - 从阶段 0 开始？
   - 还是从某个特定任务开始？

---

## 📚 相关文档

- [产品概述](./01-产品概述.md) - 了解产品整体
- [功能需求](./03-功能需求.md) - 了解功能细节
- [API 设计](./04-API设计.md) - 了解 API 规范
- [系统架构](./06-系统架构.md) - 了解技术架构
- [实现问题记录](../实现问题记录.md) - 问题记录和处理
- [开发进度](../开发进度.md) - 开发进度记录

---

## 💡 提示

- **不要被详细文档吓到**：详细文档是参考，实际开发按这个指南来
- **遇到问题就问**：不要卡在一个问题上太久
- **保持节奏**：每天完成一个小任务，保持进度
- **记录进度**：及时更新进度记录，方便我们同步

---

**准备好了吗？告诉我你的情况，我们开始吧！** 🚀
